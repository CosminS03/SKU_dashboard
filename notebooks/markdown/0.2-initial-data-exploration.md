```python
import pandas as pd
df = pd.read_csv("../data/raw/online_retail.csv")
df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 541909 entries, 0 to 541908
    Data columns (total 9 columns):
     #   Column       Non-Null Count   Dtype  
    ---  ------       --------------   -----  
     0   index        541909 non-null  int64  
     1   InvoiceNo    541909 non-null  object 
     2   StockCode    541909 non-null  object 
     3   Description  540455 non-null  object 
     4   Quantity     541909 non-null  int64  
     5   InvoiceDate  541909 non-null  object 
     6   UnitPrice    541909 non-null  float64
     7   CustomerID   406829 non-null  float64
     8   Country      541909 non-null  object 
    dtypes: float64(2), int64(2), object(5)
    memory usage: 37.2+ MB
    


```python
df[df["InvoiceNo"].str.contains(r'^(?=.*[a-zA-Z])(?=.*[0-9])[a-zA-Z0-9]+$')]["InvoiceNo"].str[0].unique()
```




    array(['C', 'A'], dtype=object)




```python
df[df["InvoiceNo"].str.contains(r'^[a-zA-Z]+$')]["InvoiceNo"].unique()
```




    array([], dtype=object)




```python
df["StockCode"].unique()
```




    array(['85123A', '71053', '84406B', ..., '90214U', '47591b', '23843'],
          shape=(4070,), dtype=object)




```python
df[df["StockCode"].str.contains(r'^(?=.*[a-zA-Z])(?=.*[0-9])[a-zA-Z0-9]+$')]["StockCode"].unique()
```




    array(['85123A', '84406B', '84029G', ..., '85179a', '90214U', '47591b'],
          shape=(1106,), dtype=object)




```python
df[df["StockCode"].str.contains(r'^\d+$')]["StockCode"].unique()
```




    array(['71053', '22752', '21730', ..., '23609', '23617', '23843'],
          shape=(2946,), dtype=object)




```python
df[df["StockCode"].str.contains(r'^[a-zA-Z]+$')]["StockCode"].unique()
```




    array(['POST', 'D', 'DOT', 'M', 'S', 'AMAZONFEE', 'm', 'DCGSSBOY',
           'DCGSSGIRL', 'PADS', 'B', 'CRUK'], dtype=object)




```python
match_mask = (
    df["StockCode"].str.contains(r'^[a-zA-Z]+$') |
    df["StockCode"].str.contains(r'^\d+$') |
    df["StockCode"].str.contains(r'^(?=.*[a-zA-Z])(?=.*[0-9])[a-zA-Z0-9]+$')
)

df[~match_mask]["StockCode"].unique()
```




    array(['BANK CHARGES', 'gift_0001_40', 'gift_0001_50', 'gift_0001_30',
           'gift_0001_20', 'gift_0001_10'], dtype=object)




```python
df[df["StockCode"] == 'gift_0001_50']
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>42057</th>
      <td>42057</td>
      <td>539958</td>
      <td>gift_0001_50</td>
      <td>Dotcomgiftshop Gift Voucher £50.00</td>
      <td>1</td>
      <td>12/23/2010 13:26</td>
      <td>42.55</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>178556</th>
      <td>178556</td>
      <td>552232</td>
      <td>gift_0001_50</td>
      <td>Dotcomgiftshop Gift Voucher £50.00</td>
      <td>1</td>
      <td>5/6/2011 15:54</td>
      <td>41.67</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>239744</th>
      <td>239744</td>
      <td>558066</td>
      <td>gift_0001_50</td>
      <td>Dotcomgiftshop Gift Voucher £50.00</td>
      <td>1</td>
      <td>6/24/2011 15:45</td>
      <td>41.67</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>245516</th>
      <td>245516</td>
      <td>558614</td>
      <td>gift_0001_50</td>
      <td>Dotcomgiftshop Gift Voucher £50.00</td>
      <td>1</td>
      <td>6/30/2011 15:56</td>
      <td>41.67</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
</div>




```python
df[df["Description"].isnull()][df["UnitPrice"] == 0]
```

    C:\Users\spanu\AppData\Local\Temp\ipykernel_12796\475170551.py:1: UserWarning: Boolean Series key will be reindexed to match DataFrame index.
      df[df["Description"].isnull()][df["UnitPrice"] == 0]
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>622</th>
      <td>622</td>
      <td>536414</td>
      <td>22139</td>
      <td>NaN</td>
      <td>56</td>
      <td>12/1/2010 11:52</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>1970</th>
      <td>1970</td>
      <td>536545</td>
      <td>21134</td>
      <td>NaN</td>
      <td>1</td>
      <td>12/1/2010 14:32</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>1971</th>
      <td>1971</td>
      <td>536546</td>
      <td>22145</td>
      <td>NaN</td>
      <td>1</td>
      <td>12/1/2010 14:33</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>1972</th>
      <td>1972</td>
      <td>536547</td>
      <td>37509</td>
      <td>NaN</td>
      <td>1</td>
      <td>12/1/2010 14:33</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>1987</th>
      <td>1987</td>
      <td>536549</td>
      <td>85226A</td>
      <td>NaN</td>
      <td>1</td>
      <td>12/1/2010 14:34</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>535322</th>
      <td>535322</td>
      <td>581199</td>
      <td>84581</td>
      <td>NaN</td>
      <td>-2</td>
      <td>12/7/2011 18:26</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>535326</th>
      <td>535326</td>
      <td>581203</td>
      <td>23406</td>
      <td>NaN</td>
      <td>15</td>
      <td>12/7/2011 18:31</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>535332</th>
      <td>535332</td>
      <td>581209</td>
      <td>21620</td>
      <td>NaN</td>
      <td>6</td>
      <td>12/7/2011 18:35</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>536981</th>
      <td>536981</td>
      <td>581234</td>
      <td>72817</td>
      <td>NaN</td>
      <td>27</td>
      <td>12/8/2011 10:33</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>538554</th>
      <td>538554</td>
      <td>581408</td>
      <td>85175</td>
      <td>NaN</td>
      <td>20</td>
      <td>12/8/2011 14:06</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
<p>1454 rows × 9 columns</p>
</div>




```python
df[
    df["Description"].str.contains(r'^(?=.*[a-z])(?=.*[0-9])(?=.*[^a-zA-Z0-9])[^A-Z]+$', na=False)][
        df["UnitPrice"] != 0]["Description"].unique()
```

    C:\Users\spanu\AppData\Local\Temp\ipykernel_12796\678323461.py:1: UserWarning: Boolean Series key will be reindexed to match DataFrame index.
      df[
    




    array([], dtype=object)




```python
df[
    df["Description"].str.contains(r'^(?=.*[A-Z])(?=.*[0-9])(?=.*[^a-zA-Z0-9][^a-z]+)$', na=False)][
        df["UnitPrice"] == 0][["Description", "UnitPrice"]]
```

    C:\Users\spanu\AppData\Local\Temp\ipykernel_12796\585262699.py:1: UserWarning: Boolean Series key will be reindexed to match DataFrame index.
      df[
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Description</th>
      <th>UnitPrice</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>




```python
df_date = pd.to_datetime(df["InvoiceDate"])

df_date.dt.year.unique()
```




    array([2010, 2011], dtype=int32)




```python
df["Country"].unique()
```




    array(['United Kingdom', 'France', 'Australia', 'Netherlands', 'Germany',
           'Norway', 'EIRE', 'Switzerland', 'Spain', 'Poland', 'Portugal',
           'Italy', 'Belgium', 'Lithuania', 'Japan', 'Iceland',
           'Channel Islands', 'Denmark', 'Cyprus', 'Sweden', 'Austria',
           'Israel', 'Finland', 'Bahrain', 'Greece', 'Hong Kong', 'Singapore',
           'Lebanon', 'United Arab Emirates', 'Saudi Arabia',
           'Czech Republic', 'Canada', 'Unspecified', 'Brazil', 'USA',
           'European Community', 'Malta', 'RSA'], dtype=object)


