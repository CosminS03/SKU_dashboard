```python
import pandas as pd

df = pd.read_csv("../data/interim/online_retail_no_outliers.csv", dtype = {"InvoiceNo": str})
```


```python
df["InvoiceDate"] = pd.to_datetime(df["InvoiceDate"])
df["Date"] = df["InvoiceDate"].dt.strftime("%Y-%m-%d")
```


```python
ros = df[~df["InvoiceNo"].str.startswith('C')].groupby(by = "SKU")["Quantity"].sum().reset_index()

no_weeks = df["Date"].nunique()

ros["Rate_of_sale"] = round((ros["Quantity"] / no_weeks), 2)
```


```python
ros.sort_values(by="Rate_of_sale", ascending=False).tail(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SKU</th>
      <th>Quantity</th>
      <th>Rate_of_sale</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1212</th>
      <td>85047</td>
      <td>3</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>215</th>
      <td>21186</td>
      <td>2</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>247</th>
      <td>21268</td>
      <td>2</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>1245</th>
      <td>85224</td>
      <td>3</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>1302</th>
      <td>90156</td>
      <td>4</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>1250</th>
      <td>90029</td>
      <td>2</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>1265</th>
      <td>90069</td>
      <td>2</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>1290</th>
      <td>90132</td>
      <td>3</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>1296</th>
      <td>90140</td>
      <td>2</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>1294</th>
      <td>90137</td>
      <td>3</td>
      <td>0.01</td>
    </tr>
  </tbody>
</table>
</div>


