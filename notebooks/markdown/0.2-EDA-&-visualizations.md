```python
import pandas as pd

df = pd.read_csv("../data/interim/online_retail_no_outliers.csv", dtype={"InvoiceNo": str})

df["Revenue"] = round(df["Quantity"] * df["UnitPrice"], 2)

sku_agg = df[~df["InvoiceNo"].str.startswith('C')].groupby(
    by=['SKU', 'Description'])["Revenue"].sum().reset_index()

sku_agg['Revenue contribution'] = round(sku_agg["Revenue"] / sku_agg["Revenue"].sum() * 100, 2)

sku_agg = sku_agg.sort_values(by='Revenue contribution', ascending=False).reset_index()
```


```python
sku_agg.tail(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>SKU</th>
      <th>Description</th>
      <th>Revenue</th>
      <th>Revenue contribution</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1365</th>
      <td>1297</td>
      <td>85195</td>
      <td>HANGING HEART BASKET</td>
      <td>23.10</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1366</th>
      <td>1326</td>
      <td>90055</td>
      <td>CRACKED GLAZE EARRINGS BROWN</td>
      <td>12.53</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1367</th>
      <td>1328</td>
      <td>90069</td>
      <td>RUBY GLASS CLUSTER NECKLACE</td>
      <td>15.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1368</th>
      <td>1332</td>
      <td>90077</td>
      <td>BLACK DIAMOND CLUSTER EARRINGS</td>
      <td>8.82</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1369</th>
      <td>1333</td>
      <td>90078</td>
      <td>PINK/WHITE GLASS DEMI CHOKER</td>
      <td>15.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1370</th>
      <td>1335</td>
      <td>90083</td>
      <td>CRYSTAL CZECH CROSS PHONE CHARM</td>
      <td>23.47</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1371</th>
      <td>1336</td>
      <td>90085</td>
      <td>CRYSTAL STILETTO PHONE CHARM</td>
      <td>36.76</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1372</th>
      <td>533</td>
      <td>22135</td>
      <td>LADLE LOVE HEART PINK</td>
      <td>24.98</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1373</th>
      <td>8</td>
      <td>16010</td>
      <td>FOLDING CAMPING SCISSOR W/KNIF &amp; S</td>
      <td>3.60</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1374</th>
      <td>4</td>
      <td>15030</td>
      <td>FAN BLACK FRAME</td>
      <td>24.07</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
#15.34% of SKUs contribute less than 0.01% to the total revenue
len(sku_agg[sku_agg["Revenue contribution"] == 0]) / len(sku_agg) * 100
```




    15.345454545454546




```python
from src import plots
```


```python
plots.percent_of_total_plot(df, "Revenue", "Revenue")
```


    
![png](0.2-EDA-%26-visualizations_files/0.2-EDA-%26-visualizations_4_0.png)
    



```python
sku_agg.truncate()
sku_agg = df[~df["InvoiceNo"].str.startswith('C')].groupby(by= ["SKU", "Description"])["Quantity"].sum().reset_index()
```


```python
sku_agg["Sales_contribution"] = round(sku_agg["Quantity"] / sku_agg["Quantity"].sum() * 100, 2)
```


```python
sku_agg = sku_agg.sort_values(by='Sales_contribution', ascending=False)
```


```python
sku_agg.head(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SKU</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>Sales_contribution</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>329</th>
      <td>21498</td>
      <td>RED RETROSPOT WRAP</td>
      <td>7476</td>
      <td>1.19</td>
    </tr>
    <tr>
      <th>785</th>
      <td>22952</td>
      <td>60 CAKE CASES VINTAGE CHRISTMAS</td>
      <td>6779</td>
      <td>1.08</td>
    </tr>
    <tr>
      <th>235</th>
      <td>21213</td>
      <td>PACK OF 72 SKULL CAKE CASES</td>
      <td>6377</td>
      <td>1.02</td>
    </tr>
    <tr>
      <th>480</th>
      <td>21975</td>
      <td>PACK OF 60 DINOSAUR CAKE CASES</td>
      <td>6244</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>328</th>
      <td>21497</td>
      <td>FANCY FONTS BIRTHDAY WRAP</td>
      <td>5450</td>
      <td>0.87</td>
    </tr>
    <tr>
      <th>484</th>
      <td>21985</td>
      <td>PACK OF 12 HEARTS DESIGN TISSUES</td>
      <td>5229</td>
      <td>0.83</td>
    </tr>
    <tr>
      <th>867</th>
      <td>23230</td>
      <td>WRAP ALPHABET DESIGN</td>
      <td>5201</td>
      <td>0.83</td>
    </tr>
    <tr>
      <th>330</th>
      <td>21499</td>
      <td>BLUE POLKADOT WRAP</td>
      <td>5002</td>
      <td>0.80</td>
    </tr>
    <tr>
      <th>331</th>
      <td>21500</td>
      <td>PINK POLKADOT WRAP</td>
      <td>4925</td>
      <td>0.79</td>
    </tr>
    <tr>
      <th>700</th>
      <td>22693</td>
      <td>GROW A FLYTRAP OR SUNFLOWER IN TIN</td>
      <td>4919</td>
      <td>0.78</td>
    </tr>
  </tbody>
</table>
</div>




```python
#21.81% of SKUs contribute less than 0.001% to the total sales
len(sku_agg[sku_agg["Sales_contribution"] == 0]) / len(sku_agg) * 100
```




    21.818181818181817




```python
plots.percent_of_total_plot(df, "Quantity", "Sales")
```


    
![png](0.2-EDA-%26-visualizations_files/0.2-EDA-%26-visualizations_10_0.png)
    

