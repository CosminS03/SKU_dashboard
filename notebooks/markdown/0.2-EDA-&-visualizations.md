```python
import pandas as pd

df = pd.read_csv("../data/interim/online_retail_no_outliers.csv", dtype={"InvoiceNo": str})

df["Revenue"] = round(df["Quantity"] * df["UnitPrice"], 2)

sku_agg = df[~df["InvoiceNo"].str.startswith('C')].groupby(
    by=['SKU', 'Description'])["Revenue"].sum().reset_index()

sku_agg['Revenue contribution'] = round(sku_agg["Revenue"] / sku_agg["Revenue"].sum() * 100, 2)

sku_agg = sku_agg.sort_values(by='Revenue contribution', ascending=False).reset_index()
```


```python
sku_agg.tail(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>SKU</th>
      <th>Description</th>
      <th>Revenue</th>
      <th>Revenue contribution</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1398</th>
      <td>567</td>
      <td>22218</td>
      <td>CAKE STAND LACE WHITE</td>
      <td>4.25</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1399</th>
      <td>546</td>
      <td>22146</td>
      <td>EASTER CRAFT IVY WREATH WITH CHICK</td>
      <td>1.95</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1400</th>
      <td>1401</td>
      <td>90159</td>
      <td>COTE D'AZURE NECKLACE</td>
      <td>29.79</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1401</th>
      <td>1380</td>
      <td>90112</td>
      <td>PINK DOLLY HAIR CLIPS</td>
      <td>2.10</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1402</th>
      <td>1385</td>
      <td>90131</td>
      <td>PINK/AMETHYST/GOLD NECKLACE</td>
      <td>34.87</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1403</th>
      <td>1386</td>
      <td>90132</td>
      <td>LIGHT TOPAZ TEAL/AQUA COL NECKLACE</td>
      <td>15.16</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1404</th>
      <td>1390</td>
      <td>90137</td>
      <td>PINK COMBO MINI CRYSTALS NECKLACE</td>
      <td>16.31</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1405</th>
      <td>1403</td>
      <td>90167</td>
      <td>BEADED LOVE HEART JEWELLERY SET</td>
      <td>8.50</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1406</th>
      <td>4</td>
      <td>15030</td>
      <td>FAN BLACK FRAME</td>
      <td>24.07</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1407</th>
      <td>2</td>
      <td>10120</td>
      <td>DOGGY RUBBER</td>
      <td>27.93</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
#28.94% of SKUs contribute less than 0.01% to the total revenue
len(sku_agg[sku_agg["Revenue contribution"] == 0]) / len(sku_agg) * 100
```




    17.329545454545457




```python
from src import plots
```


```python
plots.percent_of_total_plot(df, "Revenue", "Revenue")
```


    
![png](0.2-EDA-%26-visualizations_files/0.2-EDA-%26-visualizations_4_0.png)
    



```python
sku_agg.truncate()
sku_agg = df[~df["InvoiceNo"].str.startswith('C')].groupby(by= ["SKU", "Description"])["Quantity"].sum().reset_index()
```


```python
sku_agg["Sales_contribution"] = round(sku_agg["Quantity"] / sku_agg["Quantity"].sum() * 100, 2)
```


```python
sku_agg = sku_agg.sort_values(by='Sales_contribution', ascending=False)
```


```python
sku_agg.head(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SKU</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>Sales_contribution</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>335</th>
      <td>21498</td>
      <td>RED RETROSPOT WRAP</td>
      <td>7476</td>
      <td>1.19</td>
    </tr>
    <tr>
      <th>801</th>
      <td>22952</td>
      <td>60 CAKE CASES VINTAGE CHRISTMAS</td>
      <td>6779</td>
      <td>1.08</td>
    </tr>
    <tr>
      <th>239</th>
      <td>21213</td>
      <td>PACK OF 72 SKULL CAKE CASES</td>
      <td>6377</td>
      <td>1.02</td>
    </tr>
    <tr>
      <th>490</th>
      <td>21975</td>
      <td>PACK OF 60 DINOSAUR CAKE CASES</td>
      <td>6244</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>334</th>
      <td>21497</td>
      <td>FANCY FONTS BIRTHDAY WRAP</td>
      <td>5450</td>
      <td>0.87</td>
    </tr>
    <tr>
      <th>883</th>
      <td>23230</td>
      <td>WRAP ALPHABET DESIGN</td>
      <td>5201</td>
      <td>0.83</td>
    </tr>
    <tr>
      <th>494</th>
      <td>21985</td>
      <td>PACK OF 12 HEARTS DESIGN TISSUES</td>
      <td>5229</td>
      <td>0.83</td>
    </tr>
    <tr>
      <th>336</th>
      <td>21499</td>
      <td>BLUE POLKADOT WRAP</td>
      <td>5002</td>
      <td>0.80</td>
    </tr>
    <tr>
      <th>337</th>
      <td>21500</td>
      <td>PINK POLKADOT WRAP</td>
      <td>4925</td>
      <td>0.79</td>
    </tr>
    <tr>
      <th>715</th>
      <td>22693</td>
      <td>GROW A FLYTRAP OR SUNFLOWER IN TIN</td>
      <td>4919</td>
      <td>0.78</td>
    </tr>
  </tbody>
</table>
</div>




```python
#30.04% of SKUs contribute less than 0.001% to the total sales
len(sku_agg[sku_agg["Sales_contribution"] == 0]) / len(sku_agg) * 100
```




    23.650568181818183




```python
plots.percent_of_total_plot(df, "Quantity", "Sales")
```


    
![png](0.2-EDA-%26-visualizations_files/0.2-EDA-%26-visualizations_10_0.png)
    

