```python
import pandas as pd

df = pd.read_csv("../data/interim/online_retail_transformed.csv")
```


```python
df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 485147 entries, 0 to 485146
    Data columns (total 8 columns):
     #   Column       Non-Null Count   Dtype  
    ---  ------       --------------   -----  
     0   InvoiceNo    485147 non-null  object 
     1   SKU          485147 non-null  int64  
     2   Description  485147 non-null  object 
     3   Quantity     485147 non-null  int64  
     4   InvoiceDate  485147 non-null  object 
     5   UnitPrice    485147 non-null  float64
     6   CustomerID   485147 non-null  object 
     7   Country      485147 non-null  object 
    dtypes: float64(1), int64(2), object(5)
    memory usage: 29.6+ MB
    


```python
df['InvoiceDate'] = pd.to_datetime(df["InvoiceDate"])
```


```python
df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SKU</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>485147.000000</td>
      <td>485147.000000</td>
      <td>485147</td>
      <td>485147.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>27066.654754</td>
      <td>10.039809</td>
      <td>2011-07-07 06:23:41.996302336</td>
      <td>3.293898</td>
    </tr>
    <tr>
      <th>min</th>
      <td>10002.000000</td>
      <td>-80995.000000</td>
      <td>2010-12-01 08:26:00</td>
      <td>0.030000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>21928.000000</td>
      <td>1.000000</td>
      <td>2011-03-30 16:34:00</td>
      <td>1.250000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>22560.000000</td>
      <td>3.000000</td>
      <td>2011-07-24 12:26:00</td>
      <td>2.080000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>23139.000000</td>
      <td>12.000000</td>
      <td>2011-10-20 14:18:00</td>
      <td>4.130000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>90208.000000</td>
      <td>80995.000000</td>
      <td>2011-12-09 12:50:00</td>
      <td>649.500000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>15942.838957</td>
      <td>226.871708</td>
      <td>NaN</td>
      <td>4.573709</td>
    </tr>
  </tbody>
</table>
</div>




```python
from src import plots
```


```python
plots.winsorized_violin_plot(df["Quantity"] ,"Quantity", 0.1, 0.1)
```


    
![png](0.1-EDA-%26-visualizations_files/0.1-EDA-%26-visualizations_5_0.png)
    



```python
plots.winsorized_violin_plot(df["UnitPrice"], "Unit Price", 0, 0.1)
```


    
![png](0.1-EDA-%26-visualizations_files/0.1-EDA-%26-visualizations_6_0.png)
    



```python
df["InvoiceDate"].dt.year.unique()
```




    array([2010, 2011], dtype=int32)




```python
print(f"Data from 2010: {len(df[df["InvoiceDate"].dt.year == 2010])}")
print(f"Data from 2011: {len(df[df["InvoiceDate"].dt.year == 2011])}")
```

    Data from 2010: 36821
    Data from 2011: 448326
    


```python
wght_10 = round(len(df[df["InvoiceDate"].dt.year == 2010]) / len(df[df["InvoiceDate"].dt.year == 2011]), 2)
wght_11 = 1 - wght_10

print(f"2010: {wght_10}")
print(f"2011: {wght_11}")
```

    2010: 0.08
    2011: 0.92
    


```python
df["Revenue"] = round(df["Quantity"] * df["UnitPrice"], 2) 
```


```python
plots.winsorized_violin_plot(df["Revenue"], "Revenue", 0.1, 0.1)
```


    
![png](0.1-EDA-%26-visualizations_files/0.1-EDA-%26-visualizations_11_0.png)
    



```python
SKU_revenue = df[~df["InvoiceNo"].str.startswith('C')].groupby("SKU")["Revenue"].sum().reset_index()
```


```python
import matplotlib.pyplot as plt
import seaborn as sns

SKU_revenue["Cumulative_Revenue"] = SKU_revenue['Revenue'].cumsum()

total_revenue = SKU_revenue["Revenue"].sum()

SKU_revenue["Cumulative_percentage"] = round(SKU_revenue["Cumulative_Revenue"] / total_revenue * 100, 2)

SKU_revenue = SKU_revenue.sort_values(by= "Revenue", ascending=False).reset_index()
```


```python
SKU_revenue.head(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>SKU</th>
      <th>Revenue</th>
      <th>Cumulative_Revenue</th>
      <th>Cumulative_percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1235</td>
      <td>22423</td>
      <td>174484.74</td>
      <td>174484.74</td>
      <td>1.86</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2390</td>
      <td>23843</td>
      <td>168469.60</td>
      <td>342954.34</td>
      <td>3.66</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2468</td>
      <td>47566</td>
      <td>99504.33</td>
      <td>442458.67</td>
      <td>4.72</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1945</td>
      <td>23166</td>
      <td>81700.92</td>
      <td>524159.59</td>
      <td>5.60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1867</td>
      <td>23084</td>
      <td>66964.99</td>
      <td>591124.58</td>
      <td>6.31</td>
    </tr>
    <tr>
      <th>5</th>
      <td>931</td>
      <td>22086</td>
      <td>64952.29</td>
      <td>656076.87</td>
      <td>7.00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2666</td>
      <td>84879</td>
      <td>59094.93</td>
      <td>715171.80</td>
      <td>7.63</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2532</td>
      <td>79321</td>
      <td>54117.76</td>
      <td>769289.56</td>
      <td>8.21</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1309</td>
      <td>22502</td>
      <td>51426.62</td>
      <td>820716.18</td>
      <td>8.76</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1034</td>
      <td>22197</td>
      <td>51354.02</td>
      <td>872070.20</td>
      <td>9.31</td>
    </tr>
  </tbody>
</table>
</div>




```python
fig, ax1 = plt.subplots()

sku_order = SKU_revenue["SKU"].to_list()

sns.barplot(
    x = 'SKU', 
    y = 'Revenue', 
    data=SKU_revenue, 
    ax=ax1, 
    color='lightskyblue', 
    order=sku_order)

ax1.set_xticks([])

ax2 = ax1.twinx()
ax2.plot(
    SKU_revenue.index, 
    SKU_revenue['Cumulative_percentage'], 
    color = 'red', 
    marker = 'o',
    linestyle = '--')

ax2.set_ylim(0, 110)

plt.show()
```


    
![png](0.1-EDA-%26-visualizations_files/0.1-EDA-%26-visualizations_15_0.png)
    

