```python
import pandas as pd
df = pd.read_csv("../data/raw/online_retail.csv")
df.head(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>536365</td>
      <td>85123A</td>
      <td>WHITE HANGING HEART T-LIGHT HOLDER</td>
      <td>6</td>
      <td>12/1/2010 8:26</td>
      <td>2.55</td>
      <td>17850.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>536365</td>
      <td>71053</td>
      <td>WHITE METAL LANTERN</td>
      <td>6</td>
      <td>12/1/2010 8:26</td>
      <td>3.39</td>
      <td>17850.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>536365</td>
      <td>84406B</td>
      <td>CREAM CUPID HEARTS COAT HANGER</td>
      <td>8</td>
      <td>12/1/2010 8:26</td>
      <td>2.75</td>
      <td>17850.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>536365</td>
      <td>84029G</td>
      <td>KNITTED UNION FLAG HOT WATER BOTTLE</td>
      <td>6</td>
      <td>12/1/2010 8:26</td>
      <td>3.39</td>
      <td>17850.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>536365</td>
      <td>84029E</td>
      <td>RED WOOLLY HOTTIE WHITE HEART.</td>
      <td>6</td>
      <td>12/1/2010 8:26</td>
      <td>3.39</td>
      <td>17850.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>536365</td>
      <td>22752</td>
      <td>SET 7 BABUSHKA NESTING BOXES</td>
      <td>2</td>
      <td>12/1/2010 8:26</td>
      <td>7.65</td>
      <td>17850.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>536365</td>
      <td>21730</td>
      <td>GLASS STAR FROSTED T-LIGHT HOLDER</td>
      <td>6</td>
      <td>12/1/2010 8:26</td>
      <td>4.25</td>
      <td>17850.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>536366</td>
      <td>22633</td>
      <td>HAND WARMER UNION JACK</td>
      <td>6</td>
      <td>12/1/2010 8:28</td>
      <td>1.85</td>
      <td>17850.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>536366</td>
      <td>22632</td>
      <td>HAND WARMER RED POLKA DOT</td>
      <td>6</td>
      <td>12/1/2010 8:28</td>
      <td>1.85</td>
      <td>17850.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>536367</td>
      <td>84879</td>
      <td>ASSORTED COLOUR BIRD ORNAMENT</td>
      <td>32</td>
      <td>12/1/2010 8:34</td>
      <td>1.69</td>
      <td>13047.0</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>Quantity</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>541909.000000</td>
      <td>541909.000000</td>
      <td>541909.000000</td>
      <td>406829.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>270954.000000</td>
      <td>9.552250</td>
      <td>4.611114</td>
      <td>15287.690570</td>
    </tr>
    <tr>
      <th>std</th>
      <td>156435.797851</td>
      <td>218.081158</td>
      <td>96.759853</td>
      <td>1713.600303</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>-80995.000000</td>
      <td>-11062.060000</td>
      <td>12346.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>135477.000000</td>
      <td>1.000000</td>
      <td>1.250000</td>
      <td>13953.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>270954.000000</td>
      <td>3.000000</td>
      <td>2.080000</td>
      <td>15152.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>406431.000000</td>
      <td>10.000000</td>
      <td>4.130000</td>
      <td>16791.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>541908.000000</td>
      <td>80995.000000</td>
      <td>38970.000000</td>
      <td>18287.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.sort_values(by="Quantity").head(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>540422</th>
      <td>540422</td>
      <td>C581484</td>
      <td>23843</td>
      <td>PAPER CRAFT , LITTLE BIRDIE</td>
      <td>-80995</td>
      <td>12/9/2011 9:27</td>
      <td>2.08</td>
      <td>16446.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>61624</th>
      <td>61624</td>
      <td>C541433</td>
      <td>23166</td>
      <td>MEDIUM CERAMIC TOP STORAGE JAR</td>
      <td>-74215</td>
      <td>1/18/2011 10:17</td>
      <td>1.04</td>
      <td>12346.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>225529</th>
      <td>225529</td>
      <td>556690</td>
      <td>23005</td>
      <td>printing smudges/thrown away</td>
      <td>-9600</td>
      <td>6/14/2011 10:37</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>225530</th>
      <td>225530</td>
      <td>556691</td>
      <td>23005</td>
      <td>printing smudges/thrown away</td>
      <td>-9600</td>
      <td>6/14/2011 10:37</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>4287</th>
      <td>4287</td>
      <td>C536757</td>
      <td>84347</td>
      <td>ROTATING SILVER ANGELS T-LIGHT HLDR</td>
      <td>-9360</td>
      <td>12/2/2010 14:23</td>
      <td>0.03</td>
      <td>15838.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>225528</th>
      <td>225528</td>
      <td>556687</td>
      <td>23003</td>
      <td>Printing smudges/thrown away</td>
      <td>-9058</td>
      <td>6/14/2011 10:36</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>115818</th>
      <td>115818</td>
      <td>546152</td>
      <td>72140F</td>
      <td>throw away</td>
      <td>-5368</td>
      <td>3/9/2011 17:25</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>431381</th>
      <td>431381</td>
      <td>573596</td>
      <td>79323W</td>
      <td>Unsaleable, destroyed.</td>
      <td>-4830</td>
      <td>10/31/2011 15:17</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>341601</th>
      <td>341601</td>
      <td>566768</td>
      <td>16045</td>
      <td>NaN</td>
      <td>-3667</td>
      <td>9/14/2011 17:53</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>323458</th>
      <td>323458</td>
      <td>565304</td>
      <td>16259</td>
      <td>NaN</td>
      <td>-3167</td>
      <td>9/2/2011 12:18</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
</div>




```python
df[df["InvoiceNo"].str.startswith("C")][["InvoiceNo","Quantity"]].sort_values(
        by="Quantity", ascending=False).head(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InvoiceNo</th>
      <th>Quantity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1441</th>
      <td>C536543</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>541716</th>
      <td>C581569</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>297546</th>
      <td>C562953</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>297547</th>
      <td>C562953</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>297548</th>
      <td>C562954</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>297905</th>
      <td>C562956</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>297906</th>
      <td>C562957</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>297907</th>
      <td>C562957</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>297908</th>
      <td>C562958</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>297528</th>
      <td>C562952</td>
      <td>-1</td>
    </tr>
  </tbody>
</table>
</div>




```python
df[(df["Quantity"] < 0)][~df["InvoiceNo"].str.startswith("C")][
    ~df["Description"].isnull()]["Description"].unique()
```

    C:\Users\spanu\AppData\Local\Temp\ipykernel_16552\2450483965.py:1: UserWarning: Boolean Series key will be reindexed to match DataFrame index.
      df[(df["Quantity"] < 0)][~df["InvoiceNo"].str.startswith("C")][
    C:\Users\spanu\AppData\Local\Temp\ipykernel_16552\2450483965.py:1: UserWarning: Boolean Series key will be reindexed to match DataFrame index.
      df[(df["Quantity"] < 0)][~df["InvoiceNo"].str.startswith("C")][
    




    array(['?', 'check', 'damages', 'faulty', 'Dotcom sales',
           'reverse 21/5/10 adjustment', 'mouldy, thrown away.', 'counted',
           'Given away', 'Dotcom', 'label mix up', 'samples/damages',
           'thrown away', 'incorrectly made-thrown away.', 'showroom', 'MIA',
           'Dotcom set', 'wrongly sold as sets', 'Amazon sold sets',
           'dotcom sold sets', 'wrongly sold sets', '? sold as sets?',
           '?sold as sets?', 'Thrown away.', 'damages/display',
           'damaged stock', 'broken', 'throw away', 'wrong barcode (22467)',
           'wrong barcode', 'barcode problem', '?lost',
           "thrown away-can't sell.", "thrown away-can't sell", 'damages?',
           're dotcom quick fix.', "Dotcom sold in 6's", 'sold in set?',
           'cracked', 'sold as 22467', 'Damaged',
           'mystery! Only ever imported 1800',
           'MERCHANT CHANDLER CREDIT ERROR, STO', 'POSSIBLE DAMAGES OR LOST?',
           'damaged', 'DAMAGED', 'Display', 'Missing', 'wrong code?',
           'wrong code', 'adjust', 'crushed', 'damages/showroom etc',
           'samples', 'damages/credits from ASOS.',
           'Not rcvd in 10/11/2010 delivery', 'Thrown away-rusty',
           'sold as set/6 by dotcom', 'wet/rusty', 'damages/dotcom?',
           'smashed', 'reverse previous adjustment',
           'incorrectly credited C550456 see 47', 'wet damaged',
           'Water damaged', 'missing', 'sold as set on dotcom',
           'sold as set on dotcom and amazon', 'water damage',
           'sold as set by dotcom', 'Printing smudges/thrown away',
           'printing smudges/thrown away', 'found some more on shelf',
           'Show Samples', 'mix up with c', 'mouldy, unsaleable.',
           'wrongly marked. 23343 in box', 'stock creditted wrongly', 'ebay',
           'incorrectly put back into stock', 'Damages/samples',
           'Sold as 1 on dotcom', 'taig adjust no stock',
           'code mix up? 84930', '?display?', 'sold as 1', '?missing',
           'crushed ctn', 'Crushed', 'temp adjustment', '??', 'test',
           'OOPS ! adjustment', 'Dagamed',
           'historic computer difference?....se', 'Incorrect stock entry.',
           'incorrect stock entry.', 'wrongly coded-23343', 'stock check',
           'crushed boxes', 'WET/MOULDY', "can't find", 'mouldy',
           'Wet pallet-thrown away', 'adjustment', '20713 wrongly marked',
           're-adjustment', 'Breakages', '20713', 'wrongly coded 20713',
           'Damages', 'CHECK', 'Unsaleable, destroyed.', 'dotcom sales',
           'damages wax', 'water damaged', 'Wrongly mrked had 85123a in box',
           'wrongly marked carton 22804', 'missing?', 'wet rusty', '???lost',
           'sold with wrong barcode', 'rusty thrown away', 'rusty throw away',
           'dotcom', '?? missing', 'wet pallet', '????missing', '???missing',
           'lost in space', 'wet?', 'lost??', '???', 'wet', 'wet boxes',
           '????damages????', 'mixed up', 'lost'], dtype=object)




```python
df[df["Quantity"] > 0].sort_values(by="Quantity", ascending=False).head(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>540421</th>
      <td>540421</td>
      <td>581483</td>
      <td>23843</td>
      <td>PAPER CRAFT , LITTLE BIRDIE</td>
      <td>80995</td>
      <td>12/9/2011 9:15</td>
      <td>2.08</td>
      <td>16446.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>61619</th>
      <td>61619</td>
      <td>541431</td>
      <td>23166</td>
      <td>MEDIUM CERAMIC TOP STORAGE JAR</td>
      <td>74215</td>
      <td>1/18/2011 10:01</td>
      <td>1.04</td>
      <td>12346.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>502122</th>
      <td>502122</td>
      <td>578841</td>
      <td>84826</td>
      <td>ASSTD DESIGN 3D PAPER STICKERS</td>
      <td>12540</td>
      <td>11/25/2011 15:57</td>
      <td>0.00</td>
      <td>13256.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>74614</th>
      <td>74614</td>
      <td>542504</td>
      <td>37413</td>
      <td>NaN</td>
      <td>5568</td>
      <td>1/28/2011 12:03</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>421632</th>
      <td>421632</td>
      <td>573008</td>
      <td>84077</td>
      <td>WORLD WAR 2 GLIDERS ASSTD DESIGNS</td>
      <td>4800</td>
      <td>10/27/2011 12:26</td>
      <td>0.21</td>
      <td>12901.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>206121</th>
      <td>206121</td>
      <td>554868</td>
      <td>22197</td>
      <td>SMALL POPCORN HOLDER</td>
      <td>4300</td>
      <td>5/27/2011 10:52</td>
      <td>0.72</td>
      <td>13135.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>220843</th>
      <td>220843</td>
      <td>556231</td>
      <td>85123A</td>
      <td>?</td>
      <td>4000</td>
      <td>6/9/2011 15:04</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>97432</th>
      <td>97432</td>
      <td>544612</td>
      <td>22053</td>
      <td>EMPIRE DESIGN ROSETTE</td>
      <td>3906</td>
      <td>2/22/2011 10:43</td>
      <td>0.82</td>
      <td>18087.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>270885</th>
      <td>270885</td>
      <td>560599</td>
      <td>18007</td>
      <td>ESSENTIAL BALM 3.5g TIN IN ENVELOPE</td>
      <td>3186</td>
      <td>7/19/2011 17:04</td>
      <td>0.06</td>
      <td>14609.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>160546</th>
      <td>160546</td>
      <td>550461</td>
      <td>21108</td>
      <td>FAIRY CAKE FLANNEL ASSORTED COLOUR</td>
      <td>3114</td>
      <td>4/18/2011 13:20</td>
      <td>2.10</td>
      <td>15749.0</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
</div>




```python
#Checking the product with 'missing value' in the 'Description' column
df[df["StockCode"] == "37413"]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>74614</th>
      <td>74614</td>
      <td>542504</td>
      <td>37413</td>
      <td>NaN</td>
      <td>5568</td>
      <td>1/28/2011 12:03</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>83381</th>
      <td>83381</td>
      <td>543300</td>
      <td>37413</td>
      <td>ICON MUG REVOLUTIONARY</td>
      <td>6</td>
      <td>2/7/2011 11:42</td>
      <td>1.25</td>
      <td>13334.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>93514</th>
      <td>93514</td>
      <td>544296</td>
      <td>37413</td>
      <td>ICON MUG REVOLUTIONARY</td>
      <td>96</td>
      <td>2/17/2011 12:47</td>
      <td>0.39</td>
      <td>14298.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>103309</th>
      <td>103309</td>
      <td>545060</td>
      <td>37413</td>
      <td>ICON MUG REVOLUTIONARY</td>
      <td>6</td>
      <td>2/27/2011 13:47</td>
      <td>1.25</td>
      <td>15547.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>111562</th>
      <td>111562</td>
      <td>545764</td>
      <td>37413</td>
      <td>ICON MUG REVOLUTIONARY</td>
      <td>1</td>
      <td>3/7/2011 12:00</td>
      <td>0.39</td>
      <td>13408.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>517815</th>
      <td>517815</td>
      <td>580092</td>
      <td>37413</td>
      <td>ICON MUG REVOLUTIONARY</td>
      <td>4</td>
      <td>12/1/2011 14:38</td>
      <td>0.39</td>
      <td>13969.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>520855</th>
      <td>520855</td>
      <td>580305</td>
      <td>37413</td>
      <td>ICON MUG REVOLUTIONARY</td>
      <td>6</td>
      <td>12/2/2011 14:26</td>
      <td>0.39</td>
      <td>12970.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>525853</th>
      <td>525853</td>
      <td>580639</td>
      <td>37413</td>
      <td>ICON MUG REVOLUTIONARY</td>
      <td>1</td>
      <td>12/5/2011 12:46</td>
      <td>0.39</td>
      <td>17254.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>527465</th>
      <td>527465</td>
      <td>580720</td>
      <td>37413</td>
      <td>ICON MUG REVOLUTIONARY</td>
      <td>2</td>
      <td>12/5/2011 16:55</td>
      <td>0.39</td>
      <td>14629.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>527530</th>
      <td>527530</td>
      <td>580723</td>
      <td>37413</td>
      <td>ICON MUG REVOLUTIONARY</td>
      <td>12</td>
      <td>12/5/2011 17:09</td>
      <td>0.39</td>
      <td>15856.0</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
<p>84 rows Ã— 9 columns</p>
</div>




```python
df.sort_values(by="UnitPrice").head(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>299983</th>
      <td>299983</td>
      <td>A563186</td>
      <td>B</td>
      <td>Adjust bad debt</td>
      <td>1</td>
      <td>8/12/2011 14:51</td>
      <td>-11062.06</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>299984</th>
      <td>299984</td>
      <td>A563187</td>
      <td>B</td>
      <td>Adjust bad debt</td>
      <td>1</td>
      <td>8/12/2011 14:52</td>
      <td>-11062.06</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>204602</th>
      <td>204602</td>
      <td>554679</td>
      <td>35916A</td>
      <td>NaN</td>
      <td>-21</td>
      <td>5/25/2011 16:04</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>387137</th>
      <td>387137</td>
      <td>570259</td>
      <td>22336</td>
      <td>NaN</td>
      <td>-114</td>
      <td>10/10/2011 9:59</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>387138</th>
      <td>387138</td>
      <td>570260</td>
      <td>35933</td>
      <td>NaN</td>
      <td>-34</td>
      <td>10/10/2011 10:00</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>387139</th>
      <td>387139</td>
      <td>570261</td>
      <td>35933</td>
      <td>NaN</td>
      <td>10</td>
      <td>10/10/2011 10:00</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>423946</th>
      <td>423946</td>
      <td>573169</td>
      <td>35600A</td>
      <td>Found by jackie</td>
      <td>1</td>
      <td>10/28/2011 9:56</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>204603</th>
      <td>204603</td>
      <td>554680</td>
      <td>35916B</td>
      <td>NaN</td>
      <td>-21</td>
      <td>5/25/2011 16:04</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>204604</th>
      <td>204604</td>
      <td>554681</td>
      <td>35916C</td>
      <td>NaN</td>
      <td>-32</td>
      <td>5/25/2011 16:04</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>387140</th>
      <td>387140</td>
      <td>570262</td>
      <td>35954</td>
      <td>NaN</td>
      <td>-80</td>
      <td>10/10/2011 10:00</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
</div>




```python
df[df["InvoiceNo"].str.startswith("A")]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>299982</th>
      <td>299982</td>
      <td>A563185</td>
      <td>B</td>
      <td>Adjust bad debt</td>
      <td>1</td>
      <td>8/12/2011 14:50</td>
      <td>11062.06</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>299983</th>
      <td>299983</td>
      <td>A563186</td>
      <td>B</td>
      <td>Adjust bad debt</td>
      <td>1</td>
      <td>8/12/2011 14:51</td>
      <td>-11062.06</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>299984</th>
      <td>299984</td>
      <td>A563187</td>
      <td>B</td>
      <td>Adjust bad debt</td>
      <td>1</td>
      <td>8/12/2011 14:52</td>
      <td>-11062.06</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
</div>




```python
df[df["UnitPrice"] == 0].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>622</th>
      <td>622</td>
      <td>536414</td>
      <td>22139</td>
      <td>NaN</td>
      <td>56</td>
      <td>12/1/2010 11:52</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>1970</th>
      <td>1970</td>
      <td>536545</td>
      <td>21134</td>
      <td>NaN</td>
      <td>1</td>
      <td>12/1/2010 14:32</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>1971</th>
      <td>1971</td>
      <td>536546</td>
      <td>22145</td>
      <td>NaN</td>
      <td>1</td>
      <td>12/1/2010 14:33</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>1972</th>
      <td>1972</td>
      <td>536547</td>
      <td>37509</td>
      <td>NaN</td>
      <td>1</td>
      <td>12/1/2010 14:33</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>1987</th>
      <td>1987</td>
      <td>536549</td>
      <td>85226A</td>
      <td>NaN</td>
      <td>1</td>
      <td>12/1/2010 14:34</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.sort_values(by="UnitPrice", ascending=False).head(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>222681</th>
      <td>222681</td>
      <td>C556445</td>
      <td>M</td>
      <td>Manual</td>
      <td>-1</td>
      <td>6/10/2011 15:31</td>
      <td>38970.00</td>
      <td>15098.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>524602</th>
      <td>524602</td>
      <td>C580605</td>
      <td>AMAZONFEE</td>
      <td>AMAZON FEE</td>
      <td>-1</td>
      <td>12/5/2011 11:36</td>
      <td>17836.46</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>43702</th>
      <td>43702</td>
      <td>C540117</td>
      <td>AMAZONFEE</td>
      <td>AMAZON FEE</td>
      <td>-1</td>
      <td>1/5/2011 9:55</td>
      <td>16888.02</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>43703</th>
      <td>43703</td>
      <td>C540118</td>
      <td>AMAZONFEE</td>
      <td>AMAZON FEE</td>
      <td>-1</td>
      <td>1/5/2011 9:57</td>
      <td>16453.71</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>16356</th>
      <td>16356</td>
      <td>C537651</td>
      <td>AMAZONFEE</td>
      <td>AMAZON FEE</td>
      <td>-1</td>
      <td>12/7/2010 15:49</td>
      <td>13541.33</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>15016</th>
      <td>15016</td>
      <td>C537630</td>
      <td>AMAZONFEE</td>
      <td>AMAZON FEE</td>
      <td>-1</td>
      <td>12/7/2010 15:04</td>
      <td>13541.33</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>15017</th>
      <td>15017</td>
      <td>537632</td>
      <td>AMAZONFEE</td>
      <td>AMAZON FEE</td>
      <td>1</td>
      <td>12/7/2010 15:08</td>
      <td>13541.33</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>16232</th>
      <td>16232</td>
      <td>C537644</td>
      <td>AMAZONFEE</td>
      <td>AMAZON FEE</td>
      <td>-1</td>
      <td>12/7/2010 15:34</td>
      <td>13474.79</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>524601</th>
      <td>524601</td>
      <td>C580604</td>
      <td>AMAZONFEE</td>
      <td>AMAZON FEE</td>
      <td>-1</td>
      <td>12/5/2011 11:35</td>
      <td>11586.50</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>299982</th>
      <td>299982</td>
      <td>A563185</td>
      <td>B</td>
      <td>Adjust bad debt</td>
      <td>1</td>
      <td>8/12/2011 14:50</td>
      <td>11062.06</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
</div>




```python
df[df["StockCode"].str.contains(r"\d")].sort_values(by="UnitPrice", ascending=False).head(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>222680</th>
      <td>222680</td>
      <td>556444</td>
      <td>22502</td>
      <td>PICNIC BASKET WICKER 60 PIECES</td>
      <td>60</td>
      <td>6/10/2011 15:28</td>
      <td>649.5</td>
      <td>15098.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>222682</th>
      <td>222682</td>
      <td>556446</td>
      <td>22502</td>
      <td>PICNIC BASKET WICKER 60 PIECES</td>
      <td>1</td>
      <td>6/10/2011 15:33</td>
      <td>649.5</td>
      <td>15098.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>133994</th>
      <td>133994</td>
      <td>547814</td>
      <td>22656</td>
      <td>VINTAGE BLUE KITCHEN CABINET</td>
      <td>1</td>
      <td>3/25/2011 14:19</td>
      <td>295.0</td>
      <td>13452.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>36165</th>
      <td>36165</td>
      <td>C539438</td>
      <td>22655</td>
      <td>VINTAGE RED KITCHEN CABINET</td>
      <td>-1</td>
      <td>12/17/2010 15:11</td>
      <td>295.0</td>
      <td>16607.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>171178</th>
      <td>171178</td>
      <td>551393</td>
      <td>22656</td>
      <td>VINTAGE BLUE KITCHEN CABINET</td>
      <td>1</td>
      <td>4/28/2011 12:22</td>
      <td>295.0</td>
      <td>14973.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>118769</th>
      <td>118769</td>
      <td>546480</td>
      <td>22656</td>
      <td>VINTAGE BLUE KITCHEN CABINET</td>
      <td>1</td>
      <td>3/14/2011 11:38</td>
      <td>295.0</td>
      <td>13452.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>205759</th>
      <td>205759</td>
      <td>554836</td>
      <td>22655</td>
      <td>VINTAGE RED KITCHEN CABINET</td>
      <td>1</td>
      <td>5/26/2011 16:25</td>
      <td>295.0</td>
      <td>13015.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>87141</th>
      <td>87141</td>
      <td>C543632</td>
      <td>22655</td>
      <td>VINTAGE RED KITCHEN CABINET</td>
      <td>-1</td>
      <td>2/10/2011 16:22</td>
      <td>295.0</td>
      <td>14842.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>82768</th>
      <td>82768</td>
      <td>543253</td>
      <td>22655</td>
      <td>VINTAGE RED KITCHEN CABINET</td>
      <td>1</td>
      <td>2/4/2011 15:32</td>
      <td>295.0</td>
      <td>14842.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>32484</th>
      <td>32484</td>
      <td>539080</td>
      <td>22655</td>
      <td>VINTAGE RED KITCHEN CABINET</td>
      <td>1</td>
      <td>12/16/2010 8:41</td>
      <td>295.0</td>
      <td>16607.0</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
</div>




```python
print(df["CustomerID"].isnull().sum())
```

    135080
    


```python
df[df["CustomerID"].isnull()].tail(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>541531</th>
      <td>541531</td>
      <td>581498</td>
      <td>84997d</td>
      <td>CHILDRENS CUTLERY POLKADOT PINK</td>
      <td>1</td>
      <td>12/9/2011 10:26</td>
      <td>8.29</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>541532</th>
      <td>541532</td>
      <td>581498</td>
      <td>85038</td>
      <td>6 CHOCOLATE LOVE HEART T-LIGHTS</td>
      <td>1</td>
      <td>12/9/2011 10:26</td>
      <td>4.13</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>541533</th>
      <td>541533</td>
      <td>581498</td>
      <td>85048</td>
      <td>15CM CHRISTMAS GLASS BALL 20 LIGHTS</td>
      <td>1</td>
      <td>12/9/2011 10:26</td>
      <td>16.63</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>541534</th>
      <td>541534</td>
      <td>581498</td>
      <td>85049a</td>
      <td>TRADITIONAL CHRISTMAS RIBBONS</td>
      <td>5</td>
      <td>12/9/2011 10:26</td>
      <td>3.29</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>541535</th>
      <td>541535</td>
      <td>581498</td>
      <td>85049e</td>
      <td>SCANDINAVIAN REDS RIBBONS</td>
      <td>4</td>
      <td>12/9/2011 10:26</td>
      <td>3.29</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>541536</th>
      <td>541536</td>
      <td>581498</td>
      <td>85099B</td>
      <td>JUMBO BAG RED RETROSPOT</td>
      <td>5</td>
      <td>12/9/2011 10:26</td>
      <td>4.13</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>541537</th>
      <td>541537</td>
      <td>581498</td>
      <td>85099C</td>
      <td>JUMBO  BAG BAROQUE BLACK WHITE</td>
      <td>4</td>
      <td>12/9/2011 10:26</td>
      <td>4.13</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>541538</th>
      <td>541538</td>
      <td>581498</td>
      <td>85150</td>
      <td>LADIES &amp; GENTLEMEN METAL SIGN</td>
      <td>1</td>
      <td>12/9/2011 10:26</td>
      <td>4.96</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>541539</th>
      <td>541539</td>
      <td>581498</td>
      <td>85174</td>
      <td>S/4 CACTI CANDLES</td>
      <td>1</td>
      <td>12/9/2011 10:26</td>
      <td>10.79</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>541540</th>
      <td>541540</td>
      <td>581498</td>
      <td>DOT</td>
      <td>DOTCOM POSTAGE</td>
      <td>1</td>
      <td>12/9/2011 10:26</td>
      <td>1714.17</td>
      <td>NaN</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
</div>


