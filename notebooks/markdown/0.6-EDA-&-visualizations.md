```python
import pandas as pd

df = pd.read_csv("../data/interim/online_retail_no_outliers.csv", dtype={"InvoiceNo": str})
```


```python
total_trans = df[~df["InvoiceNo"].str.startswith('C')]["InvoiceNo"].nunique()
```


```python
upt = df[~df["InvoiceNo"].str.startswith('C')].groupby(by="SKU")["Quantity"].sum().reset_index()
```


```python
upt["Units/Trans"] = round(upt["Quantity"] / total_trans, 2)
```


```python
upt.sort_values(by="Quantity", ascending=False).head(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SKU</th>
      <th>Quantity</th>
      <th>Units/Trans</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>326</th>
      <td>21498</td>
      <td>7476</td>
      <td>0.57</td>
    </tr>
    <tr>
      <th>770</th>
      <td>22952</td>
      <td>6803</td>
      <td>0.52</td>
    </tr>
    <tr>
      <th>232</th>
      <td>21213</td>
      <td>6377</td>
      <td>0.49</td>
    </tr>
    <tr>
      <th>475</th>
      <td>21975</td>
      <td>6244</td>
      <td>0.48</td>
    </tr>
    <tr>
      <th>838</th>
      <td>23231</td>
      <td>6152</td>
      <td>0.47</td>
    </tr>
    <tr>
      <th>325</th>
      <td>21497</td>
      <td>5450</td>
      <td>0.42</td>
    </tr>
    <tr>
      <th>479</th>
      <td>21985</td>
      <td>5229</td>
      <td>0.40</td>
    </tr>
    <tr>
      <th>837</th>
      <td>23230</td>
      <td>5201</td>
      <td>0.40</td>
    </tr>
    <tr>
      <th>327</th>
      <td>21499</td>
      <td>5002</td>
      <td>0.38</td>
    </tr>
    <tr>
      <th>328</th>
      <td>21500</td>
      <td>4925</td>
      <td>0.38</td>
    </tr>
  </tbody>
</table>
</div>




```python
df[df["SKU"] == upt[upt["Units/Trans"] == upt["Units/Trans"].max()]["SKU"].iloc[0]]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InvoiceNo</th>
      <th>SKU</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>222</th>
      <td>536531</td>
      <td>21498</td>
      <td>RED RETROSPOT WRAP</td>
      <td>25</td>
      <td>2010-12-01 13:23:00</td>
      <td>0.42</td>
      <td>15485.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>224</th>
      <td>536531</td>
      <td>21498</td>
      <td>RED RETROSPOT WRAP</td>
      <td>25</td>
      <td>2010-12-01 13:23:00</td>
      <td>0.42</td>
      <td>15485.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>1267</th>
      <td>536984</td>
      <td>21498</td>
      <td>RED RETROSPOT WRAP</td>
      <td>25</td>
      <td>2010-12-03 14:35:00</td>
      <td>0.42</td>
      <td>17841.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>3181</th>
      <td>537672</td>
      <td>21498</td>
      <td>RED RETROSPOT WRAP</td>
      <td>25</td>
      <td>2010-12-08 09:30:00</td>
      <td>0.42</td>
      <td>13050.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>3301</th>
      <td>537775</td>
      <td>21498</td>
      <td>RED RETROSPOT WRAP</td>
      <td>25</td>
      <td>2010-12-08 12:41:00</td>
      <td>0.42</td>
      <td>17722.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>87993</th>
      <td>580694</td>
      <td>21498</td>
      <td>RED RETROSPOT WRAP</td>
      <td>25</td>
      <td>2011-12-05 16:00:00</td>
      <td>0.42</td>
      <td>16600.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>88064</th>
      <td>580712</td>
      <td>21498</td>
      <td>RED RETROSPOT WRAP</td>
      <td>25</td>
      <td>2011-12-05 16:37:00</td>
      <td>0.42</td>
      <td>13021.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>89606</th>
      <td>581144</td>
      <td>21498</td>
      <td>RED RETROSPOT WRAP</td>
      <td>25</td>
      <td>2011-12-07 13:46:00</td>
      <td>0.42</td>
      <td>14085.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>90212</th>
      <td>581230</td>
      <td>21498</td>
      <td>RED RETROSPOT WRAP</td>
      <td>25</td>
      <td>2011-12-08 10:24:00</td>
      <td>0.42</td>
      <td>14291.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>90622</th>
      <td>581419</td>
      <td>21498</td>
      <td>RED RETROSPOT WRAP</td>
      <td>25</td>
      <td>2011-12-08 15:03:00</td>
      <td>0.42</td>
      <td>15484.0</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
<p>301 rows Ã— 8 columns</p>
</div>




```python
from src import plots

plots.kpi_distribution(upt["Units/Trans"], "Units per Transaction")
```


    
![png](0.6-EDA-%26-visualizations_files/0.6-EDA-%26-visualizations_6_0.png)
    

